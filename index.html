<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EvgenMusic Player</title>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; text-align: center; padding: 20px; }
        .player { border: 1px solid #333; padding: 20px; border-radius: 15px; background: #1e1e1e; display: inline-block; }
        button { background: #ff4081; border: none; padding: 10px 20px; color: white; border-radius: 5px; cursor: pointer; margin-top: 10px; }
        button:hover { background: #f50057; }
        #status { margin-top: 15px; font-size: 0.9em; color: #888; }
    </style>
</head>
<body>

    <h2>Мой Плеер</h2>

    <div class="player">
        <p>Сейчас играет: <strong>Весна.mp3</strong></p>
        <button onclick="sendLike('vesna')">❤️ Поставить лайк</button>
        <div id="status">Нажми лайк, чтобы проверить связь</div>
    </div>

    <form name="likes-v1" data-netlify="true" hidden>
        <input type="text" name="songId">
    </form>

    <script>
        async function sendLike(songId) {
            const statusDiv = document.getElementById('status');
            statusDiv.innerText = "Отправка...";

            try {
                // Отправляем данные методом POST прямо на главную страницу
                // Netlify перехватит этот запрос, так как имя формы совпадает
                const response = await fetch("/", {
                    method: "POST",
                    headers: { "Content-Type": "application/x-www-form-urlencoded" },
                    body: new URLSearchParams({
                        "form-name": "likes-v1", // Должно совпадать с name в <form>
                        "songId": songId
                    }).toString(),
                });

                if (response.ok) {
                    statusDiv.innerText = "✅ Лайк улетел в Netlify Forms!";
                    statusDiv.style.color = "#4caf50";
                } else {
                    throw new Error("Ошибка сервера");
                }
            } catch (error) {
                statusDiv.innerText = "❌ Ошибка: " + error.message;
                statusDiv.style.color = "#ff5252";
            }
        }
    </script>

</body>
</html>
