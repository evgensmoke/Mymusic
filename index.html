<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EvgenMusic Player</title>
    <style>
        /* Твой крутой темный дизайн */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #121212; color: white; text-align: center; padding: 20px; }
        .player { border: 1px solid #333; padding: 30px; border-radius: 20px; background: #1e1e1e; display: inline-block; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h2 { color: #ff4081; }
        .song-info { margin-bottom: 20px; font-size: 1.2em; }
        audio { filter: invert(100%); width: 100%; margin: 15px 0; }
        button { background: #ff4081; border: none; padding: 12px 25px; color: white; border-radius: 50px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        button:hover { background: #f50057; transform: scale(1.05); }
        #status { margin-top: 15px; font-size: 0.9em; color: #888; height: 20px; }
    </style>
</head>
<body>

    <h2>Music Player v2.0</h2>

    <div class="player">
        <div class="song-info">
            <strong>Сейчас играет:</strong><br>
            <span>Весна.mp3</span>
        </div>

        <audio controls>
            <source src="весна.mp3" type="audio/mpeg">
            Ваш браузер не поддерживает плеер.
        </audio>

        <br>
        <button onclick="sendLike('vesna_track_01')">❤️ Лайкнуть песню</button>
        
        <div id="status"></div>
    </div>

    <form name="likes-v1" data-netlify="true" hidden>
        <input type="text" name="songId">
    </form>

    <script>
        async function sendLike(songId) {
            const statusDiv = document.getElementById('status');
            statusDiv.innerText = "Отправка лайка...";
            statusDiv.style.color = "#888";

            try {
                // Отправляем данные в Netlify Forms
                const response = await fetch("/index.html", {
                    method: "POST",
                    headers: { 
                        "Content-Type": "application/x-www-form-urlencoded",
                        "Accept": "application/x-www-form-urlencoded"
                    },
                    body: new URLSearchParams({
                        "form-name": "likes-v1",
                        "songId": songId
                    }).toString(),
                });

                if (response.ok) {
                    statusDiv.innerText = "✅ Лайк сохранен в админке!";
                    statusDiv.style.color = "#4caf50";
                    // Через 3 секунды убираем надпись
                    setTimeout(() => { statusDiv.innerText = ""; }, 3000);
                } else {
                    throw new Error("Ошибка связи");
                }
            } catch (error) {
                statusDiv.innerText = "❌ Ошибка: " + error.message;
                statusDiv.style.color = "#ff5252";
            }
        }
    </script>

</body>
</html>
